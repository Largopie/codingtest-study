name: Problem Solving Notification
on:
  push:
    branches: [ main ]
    paths:
      - 'ë°±ì¤€/**/*.md'
      - 'í”„ë¡œê·¸ë˜ë¨¸ìŠ¤/**/*.md'

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
        with:
          fetch-depth: 2

      - name: Get changed files
        id: changed-files
        uses: tj-actions/changed-files@v35
        with:
          files: |
            ë°±ì¤€/**/*.md
            í”„ë¡œê·¸ë˜ë¨¸ìŠ¤/**/*.md

      - name: Extract links from markdown
        uses: mipmip/github-action-markdown-link-extract-to-json@v1.1
        with:
          in-file: ${{ steps.changed-files.outputs.all_changed_files }}
          out-file: './links.json'

      - name: Read extracted links
        id: read-json
        run: echo "::set-output name=links::$(cat ./links.json)"

      - name: Send Discord notification
        uses: Ilshidur/action-discord@master
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK_URL }}
        with:
          args: |
            ğŸ¯ ìƒˆë¡œìš´ ì•Œê³ ë¦¬ì¦˜ ë¬¸ì œë¥¼ í•´ê²°í–ˆìŠµë‹ˆë‹¤!
            ë¬¸ì œ ë§í¬: ${{ steps.read-json.outputs.links }}
